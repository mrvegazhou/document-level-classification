2021-06-20 16:03:25.865115: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.10.1
******** device: cuda:0
******** device: cuda:0
*************************** (10000,) 1720 (10000,)
*************************** start encoding...
*************************** data to ids finished...
*************************** and it costs 2 min 5.84 s
  0%|          | 0/40 [00:00<?, ?it/s]*************************** sample_batch: 4 torch.Size([256, 600]) torch.int64 torch.Size([256, 600]) torch.int64 torch.Size([256, 600]) torch.int64 torch.Size([256]) torch.int64
*************************** Loading model weights...
*************************** Model loaded success!
*************************** start evaluating...

================================================================================2021-06_20 16:05:42
  2%|▎         | 1/40 [00:12<08:21, 12.86s/it]  5%|▌         | 2/40 [00:13<05:53,  9.30s/it]  8%|▊         | 3/40 [00:14<04:12,  6.84s/it] 10%|█         | 4/40 [00:16<03:07,  5.20s/it] 12%|█▎        | 5/40 [00:17<02:18,  3.95s/it] 15%|█▌        | 6/40 [00:18<01:44,  3.08s/it] 18%|█▊        | 7/40 [00:19<01:21,  2.46s/it] 20%|██        | 8/40 [00:20<01:05,  2.04s/it] 22%|██▎       | 9/40 [00:21<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:22<00:45,  1.53s/it] 28%|██▊       | 11/40 [00:23<00:40,  1.38s/it] 30%|███       | 12/40 [00:24<00:35,  1.28s/it] 32%|███▎      | 13/40 [00:25<00:32,  1.22s/it] 35%|███▌      | 14/40 [00:26<00:30,  1.17s/it] 38%|███▊      | 15/40 [00:27<00:28,  1.15s/it] 40%|████      | 16/40 [00:28<00:27,  1.14s/it] 42%|████▎     | 17/40 [00:30<00:25,  1.12s/it] 45%|████▌     | 18/40 [00:31<00:24,  1.13s/it] 48%|████▊     | 19/40 [00:32<00:24,  1.14s/it] 50%|█████     | 20/40 [00:33<00:22,  1.14s/it] 52%|█████▎    | 21/40 [00:34<00:21,  1.15s/it] 55%|█████▌    | 22/40 [00:35<00:21,  1.17s/it] 57%|█████▊    | 23/40 [00:37<00:20,  1.18s/it] 60%|██████    | 24/40 [00:38<00:18,  1.18s/it] 62%|██████▎   | 25/40 [00:39<00:18,  1.20s/it] 65%|██████▌   | 26/40 [00:40<00:17,  1.27s/it] 68%|██████▊   | 27/40 [00:42<00:16,  1.26s/it] 70%|███████   | 28/40 [00:43<00:15,  1.25s/it] 72%|███████▎  | 29/40 [00:44<00:13,  1.23s/it] 75%|███████▌  | 30/40 [00:46<00:12,  1.30s/it] 78%|███████▊  | 31/40 [00:47<00:12,  1.41s/it] 80%|████████  | 32/40 [00:49<00:11,  1.46s/it] 82%|████████▎ | 33/40 [00:50<00:10,  1.48s/it] 85%|████████▌ | 34/40 [00:52<00:08,  1.48s/it] 88%|████████▊ | 35/40 [00:53<00:07,  1.45s/it] 90%|█████████ | 36/40 [00:55<00:05,  1.45s/it] 92%|█████████▎| 37/40 [00:56<00:04,  1.45s/it] 95%|█████████▌| 38/40 [00:58<00:02,  1.45s/it] 98%|█████████▊| 39/40 [00:59<00:01,  1.47s/it]100%|██████████| 40/40 [01:00<00:00,  1.35s/it]100%|██████████| 40/40 [01:00<00:00,  1.52s/it]
evaluating costs: 60.85s
*************************** weighted_precision_score:0.951
*************************** weighted_recall_score:0.951
*************************** weighted_f1_score:0.951
*************************** accuracy:0.951
*************************** confusion_matrix:
 [[993   1   0   0   2   1   2   1   0   0]
 [  1 977   3   0   1   4   0   5   8   1]
 [  0   7 838  92   6  18  10   5   9  15]
 [  1   4  17 894  11   5  34   1   4  29]
 [  2   1   5   6 923   3  18   4  34   4]
 [  0   6  13   0   6 972   1   0   1   1]
 [  0   2   1  18   3   0 962   1   8   5]
 [  0   2   0   0   3   3   0 987   4   1]
 [  0   1   6   1   2   4   0   4 982   0]
 [  0   0   0  10   1   0   8   0   0 981]]
*************************** classification_report:
               precision    recall  f1-score   support

           0       1.00      0.99      0.99      1000
           1       0.98      0.98      0.98      1000
           2       0.95      0.84      0.89      1000
           3       0.88      0.89      0.88      1000
           4       0.96      0.92      0.94      1000
           5       0.96      0.97      0.97      1000
           6       0.93      0.96      0.95      1000
           7       0.98      0.99      0.98      1000
           8       0.94      0.98      0.96      1000
           9       0.95      0.98      0.96      1000

    accuracy                           0.95     10000
   macro avg       0.95      0.95      0.95     10000
weighted avg       0.95      0.95      0.95     10000

